<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="DccZuuiZ9TibZPtIaFy53R0h-H4tYt01uuNFgpAariI">
    <meta name="naver-site-verification" content="5e23bdf515b07e9f67d160f17584530e5971e0ab">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">
    <title>
        
          ICTë©˜í† ë§ ë”¥ëŸ¬ë‹ êµìœ¡ 2ì¼ì°¨ - kwon | kwon&#39;s Blog
        
    </title>
    <link rel="canonical" href="https://kyu9341.github.io/machinelearning/2019/11/24/marchinelearning4/">

    <link rel="canonical" href="https://kyu9341.github.io/MachineLearning/2019/11/24/marchinelearning4/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/hux-blog.min.css">


    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="kwon's Blog" type="application/atom+xml">
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">kwon&#39;s Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/archives/">Posts</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    
<!-- Image to hack wechat -->
<!-- <img src="https://kyu9341.github.io/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="{{ site.baseurl }}/{% if page.header-img %}{{ page.header-img }}{% else %}{{ site.header-img }}{% endif %}" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/home-bg.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                    </div>
                    <h1>ICTë©˜í† ë§ ë”¥ëŸ¬ë‹ êµìœ¡ 2ì¼ì°¨</h1>
                    <h2 class="subheading">Machine Learning</h2>
                    <span class="meta">
                        Posted by kwon on
                        2019-11-24
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <p>ì´ë²ˆì—ëŠ” ë‘˜ì§¸ ë‚  ë°°ìš´ ë‚´ìš©ì„ ë¦¬ë·°í•´ë³´ê² ë‹¤. ë‘˜ì§¸ ë‚ ì—ëŠ” ì´ë¯¸ì§€ ë¶„ë¥˜ ì´ë¡ , Azure Cloud GPUí™œìš©, Cifar10 ì´ë¯¸ì§€ ë¶„ë¥˜ì— ëŒ€í•´ì„œ ë°°ì› ë‹¤.</p>
<h3 id="Convolutional-Neural-Network-CNN"><a href="#Convolutional-Neural-Network-CNN" class="headerlink" title="Convolutional Neural Network(CNN)"></a>Convolutional Neural Network(CNN)</h3><p>ë”¥ëŸ¬ë‹ì´ë‚˜ ë¨¸ì‹ ëŸ¬ë‹ ê´€ë ¨ ìë£Œë“¤ì„ ë³´ë©´ ìì£¼ ë“±ì¥í•˜ë˜ CNNì´ë‹¤. ì£¼ë¡œ ì´ë¯¸ì§€ë¥¼ í•™ìŠµì‹œí‚¨ë‹¤ê³  í•˜ë©´ ì œì¼ ë¨¼ì € ë– ì˜¤ë¥´ëŠ” ë‹¨ì–´ì´ë‹¤.</p>
<p>CNN(í•©ì„±ê³± ì‹ ê²½ë§)ì€ í•„í„°ë§ ê¸°ë²•ì„ ì¸ê³µì‹ ê²½ë§ì— ì ìš©í•¨ìœ¼ë¡œì¨ ì´ë¯¸ì§€ë¥¼ ë”ìš± íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ê³ ì•ˆë˜ì—ˆë‹¤. ì´ë¯¸ì§€ë¥¼ Dense(fully connected) Layerë¡œ ì²˜ë¦¬í•˜ë ¤ í•œë‹¤ë©´ featureê°€ ë„ˆë¬´ ë§ì•„ì ¸ ë¶ˆí•„ìš”í•œ weightê°€ ë§ì•„ì§€ê³  íš¨ìœ¨ì´ ë–¨ì–´ì§€ê²Œ ëœë‹¤. ë˜í•œ Dense LayerëŠ” 1ì°¨ì› ë°ì´í„°ë§Œ inputìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— 3ì°¨ì› ë°ì´í„°ë¥¼ í‰íƒ„í™”í•˜ì—¬ ì…ë ¥í•´ì•¼ í•œë‹¤. ì—¬ê¸°ì„œ 3ì°¨ì› ë°ì´í„°ì˜ ê³µê°„ì  ì •ë³´ê°€ ì†Œì‹¤ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤. ë°˜ë©´ Convolutional Layerì—ì„œëŠ” í˜•ìƒì„ ìœ ì§€í•œë‹¤. ì…/ì¶œë ¥ ëª¨ë‘ 3ì°¨ì› ë°ì´í„°ë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ê³µê°„ì  ì •ë³´ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.</p>
<div style="width: 100%; height: 400px;">
    <img src="https://kyu9341.github.io/img/cnn.png" style="width: 100%
    ; height: 400px;">
</div>

<h4 id="Convolutional-Layer"><a href="#Convolutional-Layer" class="headerlink" title="Convolutional Layer"></a>Convolutional Layer</h4><p>Convolutionì€ í•©ì„±ê³±ì´ë¼ëŠ” ëœ»ì´ë‹¤. ìµœê·¼ì— ì˜ìƒì²˜ë¦¬ ìˆ˜ì—…ì„ ë“¤ìœ¼ë©° ë“±ì¥í–ˆë˜ ë‹¨ì–´ì´ê¸° ë•Œë¬¸ì— ì´í•´ê°€ ì˜ ë˜ì—ˆë‹¤. íŠ¹ì •í•œ í¬ê¸°ì˜ í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ì˜ ê° í”½ì…€ì„ ì§€ë‚˜ê°€ë©° í•„í„°ì˜ ìœ„ì¹˜ì— í•´ë‹¹í•˜ëŠ” í”½ì…€ê³¼ ëª¨ë‘ ê³±í•œ í›„ ê·¸ ê³±í•œ ê°’ì„ ëª¨ë‘ ë”í•˜ì—¬ í˜„ì¬ ì¤‘ì•™ í”½ì…€ ê°’ì— ë„£ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.</p>
<div style="width: 100%; height: 400px;">
    <img src="https://kyu9341.github.io/img/convolution.png" style="width: 100%
    ; height: 400px;">
</div>
ìœ„ì˜ ê·¸ë¦¼ì²˜ëŸ¼ ì´ë¯¸ì§€ì—ì„œ í•©ì„±ê³±ì´ë€ í•„í„°ë¥¼ ì´ë™ì‹œì¼œê°€ë©° ì´ë¯¸ì§€ì™€ ê³±í•œ ê²°ê³¼ë¥¼ ëª¨ë‘ ë”í•˜ëŠ” ê²ƒì¸ë°, ì´ëŸ¬í•œ í•„í„°ë¥¼ ì–´ë–¤ ê°’ì„ ë„£ì–´ ì‚¬ìš©í•˜ëŠëƒì— ë”°ë¼ ì´ë¯¸ì§€ì˜ ìƒ‰ìƒ, ë°ê¸°, ì—£ì§€ ì¶”ì¶œë“± ì—¬ëŸ¬ê°€ì§€ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ë˜í•œ í•„í„°ëŠ” ì£¼ë¡œ ì»¤ë„ì´ë¼ê³  ë¶€ë¥´ê¸°ë„ í•œë‹¤.

<h4 id="padding"><a href="#padding" class="headerlink" title="padding"></a>padding</h4><p>1ë§Œí¼ íŒ¨ë”©í–ˆë‹¤ê³  í•œë‹¤ë©´, ì…ë ¥ ë°ì´í„° ì‚¬ë°© 1í”½ì…€ì„ íŠ¹ì • ê°’ìœ¼ë¡œ ì±„ì›Œ ëŠ˜ë¦¬ëŠ” ê²ƒì„ ë§í•œë‹¤. ì£¼ë¡œ ì¶œë ¥ í¬ê¸°ë¥¼ ì¡°ì •í•  ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ”ë° ì´ë¥¼í…Œë©´ (5, 5)ë°ì´í„°ì— (3, 3)í•„í„°ë¥¼ ì ìš©í•˜ë©´ ì¶œë ¥ì´ (3, 3)ì´ ëœë‹¤. ì´ì²˜ëŸ¼ í•©ì„±ê³± ì—°ì‚°ì„ ê±°ì¹  ë•Œ ë§ˆë‹¤ í¬ê¸°ê°€ ì‘ì•„ì§€ê²Œ ë˜ëŠ”ë° ì¶œë ¥ í¬ê¸°ê°€ ë„ˆë¬´ ì¤„ì–´ë“œëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì‚¬ìš©í•œë‹¤. íŒ¨ë”©ì„ ì‚¬ìš©í•˜ë©´ ê·¸ë§Œí¼ ì…ë ¥ ë°ì´í„°ë¥¼ ê·¸ê²Œ ë§Œë“¤ì–´ ì¶œë ¥ ë°ì´í„°ë¥¼ ì…ë ¥ ë°ì´í„°ì™€ ë™ì¼í•œ í˜•ìƒìœ¼ë¡œ ì¡°ì •í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì…ë ¥ ë°ì´í„°ì˜ ê³µê°„ì  í¬ê¸°ë¥¼ ê³ ì •í•œ ì±„ë¡œ ë‹¤ìŒ ê³„ì¸µì— ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.</p>
<h4 id="Pooling-layer"><a href="#Pooling-layer" class="headerlink" title="Pooling layer"></a>Pooling layer</h4><p>í’€ë§ì€ ê°€ë¡œ/ì„¸ë¡œ ë°©í–¥ì˜ ê³µê°„ì„ ì¤„ì´ëŠ” ì—°ì‚°ì´ë‹¤. í’€ë§ì˜ ì¢…ë¥˜ë¡œëŠ” Max Poolingê³¼ Average Poolingì´ ìˆëŠ”ë° ì´ë¯¸ì§€ ì¸ì‹ ë¶„ì•¼ì—ì„œëŠ” ì£¼ë¡œ Max Poolingì„ ì‚¬ìš©í•œë‹¤.</p>
<div style="width: 100%; height: 400px;">
    <img src="https://kyu9341.github.io/img/pooling.png" style="width: 100%
    ; height: 400px;">
</div>

<ul>
<li><p>Average pooling : ì§€ì •ëœ êµ¬ì—­ì˜ í‰ê· ê°’ì„ ê°€ì ¸ì™€ ëŒ€ì²´í•¨</p>
</li>
<li><p>Max pooling layer: ì§€ì •ëœ êµ¬ì—­ì˜ ê°€ì¥ í° ê°’ì„ ê°€ì ¸ì™€ ëŒ€ì²´í•¨(ì‚¬ì†Œí•œ ì •ë³´ ì°¨ì´ëŠ” ë¬´ì‹œ)</p>
<p>ïƒ¨    ì´ë¯¸ì§€ê°€ ê°€ì§€ëŠ” í° íŠ¹ì§•ì„ ìœ ì§€í•˜ë©° ì‚¬ì´ì¦ˆë¥¼ ì¤„ì„ (íŠ¹ì§• ì¼ë°˜í™” ê°€ëŠ¥)</p>
<p>ïƒ¨    ì˜ˆë¥¼ ë“¤ì–´ ê°•ì•„ì§€ì˜ ì¢…ì´ ë‹¤ë¥¸ ê²½ìš°ì—ë„ í° íŠ¹ì§•ë§Œ ê°€ì§€ê³  ì»¤ë²„ê°€ëŠ¥</p>
<p>ïƒ¨    ë°ì´í„°ê°€ ì§€ì—­ì ìœ¼ë¡œ í•™ìŠµë˜ì§€ ì•Šë„ë¡ í•¨</p>
</li>
</ul>
<h2 id="ì‹¤ìŠµ1"><a href="#ì‹¤ìŠµ1" class="headerlink" title="ì‹¤ìŠµ1"></a>ì‹¤ìŠµ1</h2><p>ì²«ë²ˆì§¸ëŠ” ê°„ë‹¨í•˜ê²Œ ì´ë¯¸ì§€ë§Œ ë¶ˆëŸ¬ì™€ì„œ í™•ì¸í•˜ëŠ” ê³¼ì •ì´ë‹¤.</p>
<h4 id="2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN"><a href="#2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN" class="headerlink" title="2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN"></a>2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN</h4><h3 id="ì¤€ë¹„-ì‹¤ìŠµ-Image-ì‚´í´ë³´ê¸°"><a href="#ì¤€ë¹„-ì‹¤ìŠµ-Image-ì‚´í´ë³´ê¸°" class="headerlink" title="ì¤€ë¹„ ì‹¤ìŠµ. Image ì‚´í´ë³´ê¸°"></a>ì¤€ë¹„ ì‹¤ìŠµ. Image ì‚´í´ë³´ê¸°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. package ê°€ì ¸ì˜¤ê¸°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°</span></span><br><span class="line"></span><br><span class="line">image_gray = Image.open(<span class="string">'01image.png'</span>)</span><br><span class="line">image_color = Image.open(<span class="string">'02image.png'</span>)</span><br><span class="line">image_jet = Image.open(<span class="string">'jet.png'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(image_gray.size)</span><br><span class="line">print(image_gray)</span><br><span class="line"><span class="comment"># print(image_jet)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(image_color.size) <span class="comment"># sizeë§Œ ë½‘ìœ¼ë©´ ê°€ë¡œ ì„¸ë¡œë§Œ ë‚˜ì˜´</span></span><br><span class="line">print(image_gray.size)</span><br><span class="line"><span class="comment"># print(image_jet.size)</span></span><br></pre></td></tr></table></figure>

<pre><code>(28, 28)
&lt;PIL.PngImagePlugin.PngImageFile image mode=L size=28x28 at 0x1405C55AE08&gt;
(32, 32)
(28, 28)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3. ì´ë¯¸ì§€ arrayë¡œ ë³€í™˜í•˜ê¸°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">image_array = np.array(image_gray)</span><br><span class="line">image_array_color = np.array(image_color)</span><br><span class="line"><span class="comment"># image_array_jet = np.array(image_jet)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(image_array.shape) <span class="comment"># í•™ìŠµ ì‹œí‚¬ë•Œ í•­ìƒ numpy dataë¡œ ë³€í™˜í•˜ë©° shapeë¥¼ í™•ì¸í•´ì•¼í•¨</span></span><br><span class="line">print(image_array_color.shape) <span class="comment"># numpy arrayë¡œ ë³€í™˜í•˜ì—¬ ì¶œë ¥í•˜ë©´ (32, 32, 3)ì²˜ëŸ¼ ëìŠ¤ë„ ì¶œë ¥ ê°€ëŠ¥</span></span><br><span class="line"><span class="comment"># 3ì°¨ì› ë°ì´í„°ì—¬ì•¼ë§Œ CNNì— ë„£ì–´ì„œ í•™ìŠµì´ ê°€ëŠ¥ ë”°ë¼ì„œ gray scaleì€ reshapeí•´ì¤˜ì•¼í•¨</span></span><br><span class="line"><span class="comment"># print(image_array_jet.shape)</span></span><br><span class="line">reshpaed_1d = image_array.reshape(<span class="number">28</span>*<span class="number">28</span>) <span class="comment"># gray image -&gt;reshape</span></span><br><span class="line">reshaped_3d = image_array.reshape(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>) <span class="comment"># gray image -&gt; 3dë¡œ ë³€ê²½í•˜ì—¬ cnnì´ ê°€ëŠ¥í•˜ë„ë¡ í•¨</span></span><br><span class="line"></span><br><span class="line">print(reshpaed_1d.shape)</span><br><span class="line">print(reshaped_3d.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(28, 28)
(32, 32, 3)
(784,)
(28, 28, 1)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. ì´ë¯¸ì§€ ì‚´í´ë³´ê¸°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(image_array)</span></span><br><span class="line">print(image_array_color)</span><br><span class="line"><span class="comment"># print(image_array_jet)</span></span><br><span class="line"><span class="comment"># print(reshaped_3d)</span></span><br></pre></td></tr></table></figure>

<pre><code>[[[125 125 116]
  [110 101  91]
  [102  90  83]
  ...
  [202 207 214]
  [200 205 212]
  [202 208 214]]
  ...
  [143 117  82]
  [143 116  84]
  [144 116  86]]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5. ì´ë¯¸ì§€ ì‹œê°í™”</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.imshow(image_array, cmap=plt.cm.gray) <span class="comment"># gray scaleë¥¼ ì •ìƒì ìœ¼ë¡œ ë„ìš°ë ¤ë©´ color map ì„ ì§€ì •í•´ì•¼í•¨</span></span><br><span class="line">plt.imshow(image_array_color)</span><br><span class="line"><span class="comment"># plt.imshow(image_array_jet)</span></span><br></pre></td></tr></table></figure>

<pre><code>&lt;matplotlib.image.AxesImage at 0x1405c59de48&gt;</code></pre><div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_6_1.png" style="width: 50%
    ; height: 300px;">
</div>


<h2 id="ì‹¤ìŠµ2"><a href="#ì‹¤ìŠµ2" class="headerlink" title="ì‹¤ìŠµ2"></a>ì‹¤ìŠµ2</h2><p>ë‘ë²ˆì§¸ ì‹¤ìŠµì€ CNNëª¨ë¸ì„ ì ìš©í•˜ê¸° ì „ì— MLTë§Œ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ í•™ìŠµì‹œì¼œë³´ì•˜ë‹¤. MLTëŠ” 1ì°¨ì› ë°ì´í„°ë§Œ inputìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— gray scaleì˜ 2ì°¨ì› ë°ì´í„°ëŠ” 1ì°¨ì›ìœ¼ë¡œ reshapeì„ í•´ì£¼ì–´ì•¼ í•™ìŠµì´ ê°€ëŠ¥í•˜ë‹¤.</p>
<h4 id="2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-1"><a href="#2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-1" class="headerlink" title="2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN"></a>2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN</h4><h3 id="ì²«ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-MNIST-MLP"><a href="#ì²«ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-MNIST-MLP" class="headerlink" title="ì²«ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - MNIST : MLP"></a>ì²«ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - MNIST : MLP</h3><p><a href="https://keras.io/ko/datasets/#mnist" target="_blank" rel="external nofollow noopener noreferrer">Keras Dataset</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.datasets <span class="keyword">import</span> mnist  <span class="comment"># ë§ì´ ì“°ì´ëŠ” ë°ì´í„° ì¼€ë¼ìŠ¤ì—ì„œ ì œê³µ</span></span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(y_train.shape)</span><br><span class="line">print(X_test.shape)</span><br><span class="line">print(y_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(60000, 28, 28)
(60000,)
(10000, 28, 28)
(10000,)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. ì´ë¯¸ì§€ ë°ì´í„° í™•ì¸í•˜ê¸° ğŸ–¼</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">image = X_train[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">plt.imshow(image, cmap=plt.cm.gray)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;matplotlib.image.AxesImage at 0x12a2b101c48&gt;</code></pre><div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_3_1.png" style="width: 50%
    ; height: 300px;">
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(X_train.shape) <span class="comment"># 28*28 ì´ë¯¸ì§€ (2ì°¨ì›) 6ë§Œê°œ -&gt; 1ì°¨ì› 6ë§Œê°œ</span></span><br></pre></td></tr></table></figure>

<pre><code>(60000, 28, 28)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3-1. ì´ë¯¸ì§€ ë°ì´í„° ì „ì²˜ë¦¬ : 2ì°¨ì›-&gt;1ì°¨ì› ğŸŒŸğŸŒŸğŸŒŸ</span></span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape((<span class="number">60000</span>, <span class="number">28</span> * <span class="number">28</span>)) <span class="comment"># -&gt; 1ì°¨ì› 6ë§Œê°œë¡œ ë³€í™˜</span></span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span> * <span class="number">28</span>))</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(X_test.shape)</span><br><span class="line"></span><br><span class="line">print(X_train)</span><br></pre></td></tr></table></figure>

<pre><code>(60000, 784)
(10000, 784)
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3-2. ì´ë¯¸ì§€ ë°ì´í„° ì „ì²˜ë¦¬ : Normalzation</span></span><br><span class="line">X_train = X_train / <span class="number">255.0</span></span><br><span class="line">X_test = X_test / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">print(X_train[<span class="number">9</span>])</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. Label ì „ì²˜ë¦¬ (one-hot encoding)</span></span><br><span class="line">print(y_train[:<span class="number">10</span>]) <span class="comment"># ì•ì—ì„œ 10ê°œ, label : ìˆ«ìê°€ ì–´ë–¤ ìˆ«ìì¸ì§€</span></span><br></pre></td></tr></table></figure>

<pre><code>[5 0 4 1 9 2 1 3 1 4]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. Label ì „ì²˜ë¦¬ (one-hot encoding)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> to_categorical</span><br><span class="line">y_train = to_categorical(y_train)</span><br><span class="line">y_test = to_categorical(y_test)</span><br><span class="line"></span><br><span class="line">print(y_train[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure>

<pre><code>[[0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4-1 Validation ì…‹ ë‚˜ëˆ„ê¸°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">X_train, X_val, y_train, y_val = train_test_split(X_train, y_train,</span><br><span class="line">                                                    test_size=<span class="number">0.2</span>,</span><br><span class="line">                                                    random_state=<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(y_train.shape)</span><br><span class="line"></span><br><span class="line">print(X_val.shape)</span><br><span class="line">print(y_val.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(48000, 784)
(48000, 10)
(12000, 784)
(12000, 10)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5. ëª¨ë¸ ìƒì„± : MLP</span></span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense</span><br><span class="line"></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(Dense(<span class="number">512</span>, input_dim=<span class="number">784</span>, activation=<span class="string">'relu'</span>)) <span class="comment"># ë‹¤ìŒ ë…¸ë“œì˜ ìˆ˜ : 512(inputdataê°€ 784ì´ë¯€ë¡œ ì ë‹¹íˆ í¬ê²Œ)</span></span><br><span class="line">model.add(Dense(<span class="number">10</span>, activation=<span class="string">'softmax'</span>)) <span class="comment"># ì¶œë ¥ ì¸µ 10ê°œì¤‘ ì–´ë–¤ê±´ì§€ ì•Œê¸° ìœ„í•´ 10ìœ¼ë¡œ ì§€ì •</span></span><br><span class="line"></span><br><span class="line">print(model.summary())</span><br></pre></td></tr></table></figure>

<pre><code>Model: &quot;sequential_6&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_9 (Dense)              (None, 512)               401920    
_________________________________________________________________
dense_10 (Dense)             (None, 10)                5130      
=================================================================
Total params: 407,050
Trainable params: 407,050
Non-trainable params: 0
_________________________________________________________________
None</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6. Compile - Optimizer, Loss function ì„¤ì •</span></span><br><span class="line">model.compile(loss=<span class="string">'categorical_crossentropy'</span>,</span><br><span class="line">              optimizer=<span class="string">'sgd'</span>,</span><br><span class="line">              metrics=[<span class="string">'accuracy'</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 7. ëª¨ë¸ í•™ìŠµì‹œí‚¤ê¸°</span></span><br><span class="line"></span><br><span class="line">batch_size=<span class="number">128</span></span><br><span class="line">epochs=<span class="number">10</span></span><br><span class="line"></span><br><span class="line">history = model.fit(X_train, y_train,</span><br><span class="line">         epochs=epochs,</span><br><span class="line">         batch_size=batch_size,</span><br><span class="line">         validation_data=(X_val, y_val), <span class="comment"># validation_set ì ìš© (ê¼­ ê°™ì´ í•´ì£¼ëŠ”ê²Œ ì¢‹ìŒ)</span></span><br><span class="line">         verbose=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<pre><code>Train on 48000 samples, validate on 12000 samples
Epoch 1/10
48000/48000 [==============================] - 2s 37us/step - loss: 1.2137 - accuracy: 0.7386 - val_loss: 0.6995 - val_accuracy: 0.8526
Epoch 2/10
48000/48000 [==============================] - 2s 34us/step - loss: 0.5725 - accuracy: 0.8683 - val_loss: 0.4960 - val_accuracy: 0.8789
Epoch 3/10
48000/48000 [==============================] - 2s 42us/step - loss: 0.4501 - accuracy: 0.8855 - val_loss: 0.4243 - val_accuracy: 0.8904
Epoch 4/10
48000/48000 [==============================] - 2s 40us/step - loss: 0.3967 - accuracy: 0.8948 - val_loss: 0.3847 - val_accuracy: 0.8984
Epoch 5/10
48000/48000 [==============================] - 2s 40us/step - loss: 0.3648 - accuracy: 0.9019 - val_loss: 0.3599 - val_accuracy: 0.9035
Epoch 6/10
48000/48000 [==============================] - 2s 40us/step - loss: 0.3425 - accuracy: 0.9064 - val_loss: 0.3419 - val_accuracy: 0.9077
Epoch 7/10
48000/48000 [==============================] - 2s 38us/step - loss: 0.3257 - accuracy: 0.9103 - val_loss: 0.3276 - val_accuracy: 0.9109
Epoch 8/10
48000/48000 [==============================] - 2s 40us/step - loss: 0.3121 - accuracy: 0.9145 - val_loss: 0.3155 - val_accuracy: 0.9133
Epoch 9/10
48000/48000 [==============================] - 2s 41us/step - loss: 0.3006 - accuracy: 0.9174 - val_loss: 0.3064 - val_accuracy: 0.9160
Epoch 10/10
48000/48000 [==============================] - 2s 40us/step - loss: 0.2906 - accuracy: 0.9201 - val_loss: 0.2977 - val_accuracy: 0.9183</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 8. ëª¨ë¸ í‰ê°€í•˜ê¸°</span></span><br><span class="line">test_loss, test_acc = model.evaluate(X_test, y_test)</span><br><span class="line"></span><br><span class="line">print(test_loss, test_acc)</span><br></pre></td></tr></table></figure>

<pre><code>10000/10000 [==============================] - 0s 25us/step
0.2771936253398657 0.9223999977111816</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 9. ì´ë¯¸ì§€ë¥¼ ëœë¤ìœ¼ë¡œ ì„ íƒí•´ í›ˆë ¨ëœ ëª¨ë¸ë¡œ ì˜ˆì¸¡ ğŸ–¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> numpy.random.choice(len(y_test), <span class="number">3</span>, replace = <span class="literal">False</span>):</span><br><span class="line">    predicted = model.predict(X_test[index:index + <span class="number">1</span>])[<span class="number">0</span>]</span><br><span class="line">    label = y_test[index]</span><br><span class="line">    result_label = numpy.where(label == numpy.amax(label))</span><br><span class="line">    result_predicted = numpy.where(predicted == numpy.amax(predicted))</span><br><span class="line">    title = <span class="string">"Label value = %s  Predicted value = %s "</span> % (result_label[<span class="number">0</span>], result_predicted[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    fig = plt.figure(<span class="number">1</span>, figsize = (<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">    ax1 = fig.add_axes((<span class="number">0</span>,<span class="number">0</span>,<span class="number">.8</span>,<span class="number">.8</span>))</span><br><span class="line">    ax1.set_title(title)</span><br><span class="line">    images = X_test</span><br><span class="line">    plt.imshow(images[index].reshape(<span class="number">28</span>, <span class="number">28</span>), cmap = <span class="string">'Greys'</span>, interpolation = <span class="string">'nearest'</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_14_0.png" style="width: 50%
    ; height: 300px;">
</div>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_14_1.png" style="width: 50%
    ; height: 300px;">
</div>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_14_2.png" style="width: 50%
    ; height: 300px;">
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 10. í•™ìŠµ ì‹œê°í™”í•˜ê¸°</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">'val_accuracy'</span>])</span><br><span class="line">plt.plot(history.history[<span class="string">'accuracy'</span>])</span><br><span class="line">plt.title(<span class="string">'Accuracy'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'epoch'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'accuracy'</span>)</span><br><span class="line">plt.legend([<span class="string">'train'</span>, <span class="string">'test'</span>], loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># plt.plot(history.history['val_accuracy'])</span></span><br></pre></td></tr></table></figure>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_15_0.png" style="width: 50%
    ; height: 300px;">
</div>



<h2 id="ì‹¤ìŠµ3"><a href="#ì‹¤ìŠµ3" class="headerlink" title="ì‹¤ìŠµ3"></a>ì‹¤ìŠµ3</h2><p>ì´ë²ˆì—ëŠ” ì‹¤ì œë¡œ CNNì„ ì‚¬ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ì„ ìˆ˜í–‰í–ˆë‹¤. MLTë¥¼ ìˆ˜í–‰í•˜ê¸° ì´ì „ì— Convolution Layer ë° Pooling Layerë¥¼ ê±°ì³ í•™ìŠµì´ ì§„í–‰ëœë‹¤.</p>
<h4 id="2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-2"><a href="#2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-2" class="headerlink" title="2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN"></a>2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN</h4><h3 id="ë‘ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-MNIST-CNN"><a href="#ë‘ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-MNIST-CNN" class="headerlink" title="ë‘ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - MNIST : CNN"></a>ë‘ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - MNIST : CNN</h3><p><a href="https://keras.io/ko/datasets/#mnist" target="_blank" rel="external nofollow noopener noreferrer">Keras Dataset</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</span></span><br><span class="line"><span class="keyword">from</span> keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = mnist.load_data()</span><br><span class="line"></span><br><span class="line">X_train, X_val, y_train, y_val = train_test_split(X_train, y_train,</span><br><span class="line">                                                 test_size=<span class="number">0.2</span>,</span><br><span class="line">                                                 random_state=<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(y_train.shape)</span><br><span class="line">print(X_test.shape)</span><br><span class="line">print(y_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(48000, 28, 28)
(48000,)
(10000, 28, 28)
(10000,)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. ì´ë¯¸ì§€ ë°ì´í„° í™•ì¸í•˜ê¸° ğŸ–¼</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">image = X_train[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">plt.imshow(image, cmap=plt.cm.gray)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;matplotlib.image.AxesImage at 0x240c6b78c48&gt;</code></pre><div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_3_1a.png" style="width: 50%
    ; height: 300px;">
</div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3-1. ì´ë¯¸ì§€ ë°ì´í„° ì „ì²˜ë¦¬ : 2ì°¨ì›-&gt;3ì°¨ì› ğŸŒŸğŸŒŸğŸŒŸ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># w=h=28            </span></span><br><span class="line"><span class="comment"># X_train = X_train.reshape(X_train.shape[0], w, h, 1)</span></span><br><span class="line"><span class="comment"># ìœ„ì˜ ë‘ì¤„ë¡œ ëŒ€ì²´ ê°€ëŠ¥ ìœ„ì˜ ë°©ì‹ì´ ì¬ì‚¬ìš©ì— ìš©ì´</span></span><br><span class="line"></span><br><span class="line">X_train = X_train.reshape(<span class="number">48000</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">X_val = X_val.reshape(<span class="number">12000</span>, <span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>)</span><br><span class="line">X_test = X_test.reshape((<span class="number">10000</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(X_val.shape)</span><br><span class="line"></span><br><span class="line">print(X_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(48000, 28, 28, 1)
(12000, 28, 28, 1)
(10000, 28, 28, 1)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3-2. ì´ë¯¸ì§€ ë°ì´í„° ì „ì²˜ë¦¬ : Normalzation</span></span><br><span class="line">X_train = X_train / <span class="number">255.0</span></span><br><span class="line">X_val = X_val / <span class="number">255.0</span></span><br><span class="line">X_test = X_test / <span class="number">255.0</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. Label ì „ì²˜ë¦¬ (one-hot encoding)</span></span><br><span class="line"></span><br><span class="line">print(y_train[:<span class="number">10</span>]) <span class="comment"># ì•ì—ì„œ 10ê°œ, label : ìˆ«ìê°€ ì–´ë–¤ ìˆ«ìì¸ì§€</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> to_categorical</span><br><span class="line">y_train = to_categorical(y_train)</span><br><span class="line">y_val = to_categorical(y_val)</span><br><span class="line">y_test = to_categorical(y_test)</span><br><span class="line"></span><br><span class="line">print(y_train[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure>

<pre><code>[9 9 9 5 3 2 0 4 2 7]
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5. ëª¨ë¸ ìƒì„± : CNN ğŸŒŸğŸŒŸğŸŒŸ</span></span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense, Conv2D, MaxPooling2D, Flatten</span><br><span class="line"></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(Conv2D(filters=<span class="number">32</span>,</span><br><span class="line">                kernel_size=(<span class="number">3</span>,<span class="number">3</span>),</span><br><span class="line">                padding=<span class="string">'same'</span>,</span><br><span class="line">                activation=<span class="string">'relu'</span>,</span><br><span class="line">                input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)))</span><br><span class="line">model.add(MaxPooling2D(pool_size=(<span class="number">2</span>,<span class="number">2</span>)))</span><br><span class="line">model.add(Flatten())</span><br><span class="line">model.add(Dense(<span class="number">128</span>, activation=<span class="string">'relu'</span>))</span><br><span class="line">model.add(Dense(<span class="number">10</span>, activation=<span class="string">'softmax'</span>))</span><br><span class="line"></span><br><span class="line">print(model.summary())</span><br></pre></td></tr></table></figure>

<pre><code>Model: &quot;sequential_10&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_9 (Conv2D)            (None, 28, 28, 32)        320       
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 14, 14, 32)        0         
_________________________________________________________________
flatten_6 (Flatten)          (None, 6272)              0         
_________________________________________________________________
dense_9 (Dense)              (None, 128)               802944    
_________________________________________________________________
dense_10 (Dense)             (None, 10)                1290      
=================================================================
Total params: 804,554
Trainable params: 804,554
Non-trainable params: 0
_________________________________________________________________
None</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6. Compile - Optimizer, Loss function ì„¤ì •</span></span><br><span class="line">model.compile(loss=<span class="string">'categorical_crossentropy'</span>,</span><br><span class="line">              optimizer=<span class="string">'sgd'</span>,</span><br><span class="line">              metrics=[<span class="string">'accuracy'</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 7. ëª¨ë¸ í•™ìŠµì‹œí‚¤ê¸°</span></span><br><span class="line"></span><br><span class="line">batch_size=<span class="number">128</span></span><br><span class="line">epochs=<span class="number">10</span></span><br><span class="line"></span><br><span class="line">history = model.fit(X_train, y_train,</span><br><span class="line">         epochs=epochs,</span><br><span class="line">         batch_size=batch_size,</span><br><span class="line">         validation_data=(X_val, y_val), <span class="comment"># validation_set ì ìš© (ê¼­ ê°™ì´ í•´ì£¼ëŠ”ê²Œ ì¢‹ìŒ)</span></span><br><span class="line">         verbose=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<pre><code>W1124 16:01:22.815376 23724 deprecation_wrapper.py:119] From c:\users\kyu93\appdata\local\programs\python\python37\lib\site-packages\keras\backend\tensorflow_backend.py:422: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.



Train on 48000 samples, validate on 12000 samples
Epoch 1/10
48000/48000 [==============================] - 10s 203us/step - loss: 1.1062 - accuracy: 0.7491 - val_loss: 0.4400 - val_accuracy: 0.8799
Epoch 2/10
48000/48000 [==============================] - 10s 207us/step - loss: 0.3706 - accuracy: 0.8950 - val_loss: 0.3396 - val_accuracy: 0.9028
Epoch 3/10
48000/48000 [==============================] - 12s 242us/step - loss: 0.3099 - accuracy: 0.9095 - val_loss: 0.3000 - val_accuracy: 0.9153
Epoch 4/10
48000/48000 [==============================] - 12s 245us/step - loss: 0.2787 - accuracy: 0.9186 - val_loss: 0.2750 - val_accuracy: 0.9217
Epoch 5/10
48000/48000 [==============================] - 12s 244us/step - loss: 0.2548 - accuracy: 0.9252 - val_loss: 0.2543 - val_accuracy: 0.9284
Epoch 6/10
48000/48000 [==============================] - 12s 252us/step - loss: 0.2348 - accuracy: 0.9316 - val_loss: 0.2379 - val_accuracy: 0.9331
Epoch 7/10
48000/48000 [==============================] - 12s 251us/step - loss: 0.2173 - accuracy: 0.9372 - val_loss: 0.2233 - val_accuracy: 0.9353
Epoch 8/10
48000/48000 [==============================] - 13s 269us/step - loss: 0.2025 - accuracy: 0.9405 - val_loss: 0.2106 - val_accuracy: 0.9405
Epoch 9/10
48000/48000 [==============================] - 13s 265us/step - loss: 0.1898 - accuracy: 0.9446 - val_loss: 0.1987 - val_accuracy: 0.9421
Epoch 10/10
48000/48000 [==============================] - 12s 251us/step - loss: 0.1782 - accuracy: 0.9475 - val_loss: 0.1957 - val_accuracy: 0.9433</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 8. ëª¨ë¸ í‰ê°€í•˜ê¸°</span></span><br><span class="line">test_loss, test_acc = model.evaluate(X_test, y_test)</span><br></pre></td></tr></table></figure>

<pre><code>10000/10000 [==============================] - 1s 83us/step</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 9. ì´ë¯¸ì§€ë¥¼ ëœë¤ìœ¼ë¡œ ì„ íƒí•´ í›ˆë ¨ëœ ëª¨ë¸ë¡œ ì˜ˆì¸¡ ğŸ–¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> numpy.random.choice(len(y_test), <span class="number">3</span>, replace = <span class="literal">False</span>):</span><br><span class="line">    predicted = model.predict(X_test[index:index + <span class="number">1</span>])[<span class="number">0</span>]</span><br><span class="line">    label = y_test[index]</span><br><span class="line">    result_label = numpy.where(label == numpy.amax(label))</span><br><span class="line">    result_predicted = numpy.where(predicted == numpy.amax(predicted))</span><br><span class="line">    title = <span class="string">"Label value = %s  Predicted value = %s "</span> % (result_label[<span class="number">0</span>], result_predicted[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    fig = plt.figure(<span class="number">1</span>, figsize = (<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">    ax1 = fig.add_axes((<span class="number">0</span>,<span class="number">0</span>,<span class="number">.8</span>,<span class="number">.8</span>))</span><br><span class="line">    ax1.set_title(title)</span><br><span class="line">    images = X_test</span><br><span class="line">    plt.imshow(images[index].reshape(<span class="number">28</span>, <span class="number">28</span>), cmap = <span class="string">'Greys'</span>, interpolation = <span class="string">'nearest'</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_0a.png" style="width: 50%
    ; height: 300px;">
</div>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_1a.png" style="width: 50%
    ; height: 300px;">
</div>


<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_2a.png" style="width: 50%
    ; height: 300px;">
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 10. í•™ìŠµ ì‹œê°í™”í•˜ê¸°</span></span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">'val_accuracy'</span>])</span><br><span class="line">plt.plot(history.history[<span class="string">'accuracy'</span>])</span><br><span class="line">plt.title(<span class="string">'Accuracy'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'epoch'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'accuracy'</span>)</span><br><span class="line">plt.legend([<span class="string">'train'</span>, <span class="string">'test'</span>], loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">'loss'</span>])</span><br><span class="line">plt.plot(history.history[<span class="string">'val_loss'</span>])</span><br><span class="line">plt.title(<span class="string">'Loss'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'epoch'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'loss'</span>)</span><br><span class="line">plt.legend([<span class="string">'train'</span>, <span class="string">'test'</span>], loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_12_0a.png" style="width: 50%
    ; height: 300px;">
</div>


<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_12_1a.png" style="width: 50%
    ; height: 300px;">
</div>


<h2 id="ì‹¤ìŠµ4"><a href="#ì‹¤ìŠµ4" class="headerlink" title="ì‹¤ìŠµ4"></a>ì‹¤ìŠµ4</h2><p>ìœ„ì—ì„œ í•™ìŠµí•œ ë°©ì‹ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì—¬ Fashion MNIST ë°ì´í„°ì— ì ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ì„ ìˆ˜í–‰í•´ë³´ì•˜ë‹¤.</p>
<h4 id="2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-3"><a href="#2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-3" class="headerlink" title="2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN"></a>2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN</h4><h3 id="ì„¸ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-Fashion-MNIST-CNN"><a href="#ì„¸ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-Fashion-MNIST-CNN" class="headerlink" title="ì„¸ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - Fashion MNIST : CNN"></a>ì„¸ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - Fashion MNIST : CNN</h3><p><a href="https://keras.io/ko/datasets/#-mnist" target="_blank" rel="external nofollow noopener noreferrer">Keras Dataset</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</span></span><br><span class="line"><span class="keyword">from</span> keras.datasets <span class="keyword">import</span> fashion_mnist</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = fashion_mnist.load_data()</span><br><span class="line"></span><br><span class="line">X_train, X_val, y_train, y_val = train_test_split(X_train, y_train,</span><br><span class="line">                                                 test_size=<span class="number">0.2</span>,</span><br><span class="line">                                                 random_state=<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(y_train.shape)</span><br><span class="line">print(X_val.shape)</span><br><span class="line">print(y_val.shape)</span><br><span class="line">print(X_test.shape)</span><br><span class="line">print(y_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(48000, 28, 28)
(48000,)
(12000, 28, 28)
(12000,)
(10000, 28, 28)
(10000,)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. ì´ë¯¸ì§€ ë°ì´í„° í™•ì¸í•˜ê¸° ğŸ–¼</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">image = X_train[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">plt.imshow(image, cmap = plt.cm.gray)</span><br></pre></td></tr></table></figure>


<pre><code>&lt;matplotlib.image.AxesImage at 0x2ab820aac08&gt;</code></pre><div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_3_1b.png" style="width: 50%
    ; height: 300px;">
</div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3-1. ì´ë¯¸ì§€ ë°ì´í„° ì „ì²˜ë¦¬ : 2ì°¨ì›-&gt;3ì°¨ì› ğŸŒŸğŸŒŸğŸŒŸ</span></span><br><span class="line">X_train = X_train.reshape(<span class="number">48000</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">X_val = X_val.reshape(<span class="number">12000</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">X_test = X_test.reshape(<span class="number">10000</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(X_val.shape)</span><br><span class="line">print(X_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(48000, 28, 28, 1)
(12000, 28, 28, 1)
(10000, 28, 28, 1)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3-2. ì´ë¯¸ì§€ ë°ì´í„° ì „ì²˜ë¦¬ : Normalzation</span></span><br><span class="line"></span><br><span class="line">X_train = X_train / <span class="number">255.0</span></span><br><span class="line">X_val = X_val / <span class="number">255.0</span></span><br><span class="line">X_test = X_test / <span class="number">255.0</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. Label categorical (one-hot encoding)</span></span><br><span class="line">print(y_train[:<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> to_categorical</span><br><span class="line">y_train = to_categorical(y_train)</span><br><span class="line">y_val = to_categorical(y_val)</span><br><span class="line">y_test = to_categorical(y_test)</span><br><span class="line"></span><br><span class="line">print(y_train[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure>

<pre><code>[3 1 2 6 7 3 5 1 1 5]
[[0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5. ëª¨ë¸ ìƒì„± : CNN</span></span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense, Conv2D, MaxPool2D, Flatten, Dropout</span><br><span class="line"></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(Conv2D(filters=<span class="number">32</span>,  <span class="comment"># í•„í„°ì˜ ê°œìˆ˜</span></span><br><span class="line">                kernel_size=(<span class="number">3</span>,<span class="number">3</span>),  <span class="comment"># í•„í„° ì‚¬ì´ì¦ˆ</span></span><br><span class="line">                padding=<span class="string">'same'</span>,  <span class="comment"># padding</span></span><br><span class="line">                activation=<span class="string">'relu'</span>,  <span class="comment"># activation í•¨ìˆ˜ ì„¤ì •</span></span><br><span class="line">                input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))) <span class="comment"># (input_dim)</span></span><br><span class="line"></span><br><span class="line">model.add(MaxPool2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>))) <span class="comment"># ë³´í†µ (2,2)ë¥¼ ë„£ìŒ</span></span><br><span class="line">model.add(Flatten())</span><br><span class="line">model.add(Dense(<span class="number">128</span>, activation=<span class="string">'relu'</span>))</span><br><span class="line">model.add(Dropout(<span class="number">0.3</span>))<span class="comment"># Dropout ì„¤ì •</span></span><br><span class="line">model.add(Dense(<span class="number">10</span>, activation=<span class="string">'softmax'</span>)) <span class="comment"># ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œì´ê¸° ë•Œë¬¸ì— softmax</span></span><br><span class="line"></span><br><span class="line">print(model.summary())</span><br></pre></td></tr></table></figure>

<pre><code>Model: &quot;sequential_5&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_5 (Conv2D)            (None, 28, 28, 32)        320       
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 14, 14, 32)        0         
_________________________________________________________________
flatten_5 (Flatten)          (None, 6272)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 128)               802944    
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 10)                1290      
=================================================================
Total params: 804,554
Trainable params: 804,554
Non-trainable params: 0
_________________________________________________________________
None</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6. Compile - Optimizer, Loss function ì„¤ì •</span></span><br><span class="line">model.compile(loss=<span class="string">'categorical_crossentropy'</span>,</span><br><span class="line">             optimizer=<span class="string">'adam'</span>,</span><br><span class="line">             metrics=[<span class="string">'accuracy'</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 7. ëª¨ë¸ í•™ìŠµì‹œí‚¤ê¸°</span></span><br><span class="line">batch_size = <span class="number">128</span></span><br><span class="line">epochs = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">history = model.fit(X_train, y_train,</span><br><span class="line">                    epochs=epochs,</span><br><span class="line">                    batch_size=batch_size,</span><br><span class="line">                    validation_data=(X_val, y_val), <span class="comment"># validation_set ì ìš© (ê¼­ ê°™ì´ í•´ì£¼ëŠ”ê²Œ ì¢‹ìŒ)</span></span><br><span class="line">                    verbose=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<pre><code>Train on 48000 samples, validate on 12000 samples
Epoch 1/10
48000/48000 [==============================] - 25s 511us/step - loss: 0.5189 - accuracy: 0.8164 - val_loss: 0.3606 - val_accuracy: 0.8741
Epoch 2/10
48000/48000 [==============================] - 23s 488us/step - loss: 0.3464 - accuracy: 0.8777 - val_loss: 0.3015 - val_accuracy: 0.8932
Epoch 3/10
48000/48000 [==============================] - 23s 487us/step - loss: 0.2950 - accuracy: 0.8942 - val_loss: 0.2767 - val_accuracy: 0.9023
Epoch 4/10
48000/48000 [==============================] - 23s 484us/step - loss: 0.2648 - accuracy: 0.9041 - val_loss: 0.2626 - val_accuracy: 0.9061
Epoch 5/10
48000/48000 [==============================] - 23s 480us/step - loss: 0.2444 - accuracy: 0.9106 - val_loss: 0.2510 - val_accuracy: 0.9106
Epoch 6/10
48000/48000 [==============================] - 23s 479us/step - loss: 0.2241 - accuracy: 0.9170 - val_loss: 0.2577 - val_accuracy: 0.9068
Epoch 7/10
48000/48000 [==============================] - 24s 503us/step - loss: 0.2093 - accuracy: 0.9236 - val_loss: 0.2417 - val_accuracy: 0.9126
Epoch 8/10
48000/48000 [==============================] - 24s 509us/step - loss: 0.1926 - accuracy: 0.9288 - val_loss: 0.2380 - val_accuracy: 0.9153
Epoch 9/10
48000/48000 [==============================] - 24s 504us/step - loss: 0.1821 - accuracy: 0.9325 - val_loss: 0.2352 - val_accuracy: 0.9190
Epoch 10/10
48000/48000 [==============================] - 24s 506us/step - loss: 0.1699 - accuracy: 0.9368 - val_loss: 0.2329 - val_accuracy: 0.9191</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 8. ëª¨ë¸ í‰ê°€í•˜ê¸°</span></span><br><span class="line">test_loss, test_acc = model.evaluate(X_test, y_test)</span><br></pre></td></tr></table></figure>

<pre><code>10000/10000 [==============================] - 2s 206us/step</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 9. ì´ë¯¸ì§€ë¥¼ ëœë¤ìœ¼ë¡œ ì„ íƒí•´ í›ˆë ¨ëœ ëª¨ë¸ë¡œ ì˜ˆì¸¡ ğŸ–¼</span></span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> numpy.random.choice(len(y_test), <span class="number">3</span>, replace = <span class="literal">False</span>):</span><br><span class="line">    predicted = model.predict(X_test[index:index + <span class="number">1</span>])[<span class="number">0</span>]</span><br><span class="line">    label = y_test[index]</span><br><span class="line">    result_label = numpy.where(label == numpy.amax(label))</span><br><span class="line">    result_predicted = numpy.where(predicted == numpy.amax(predicted))</span><br><span class="line">    title = <span class="string">"Label value = %s  Predicted value = %s "</span> % (result_label[<span class="number">0</span>], result_predicted[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    fig = plt.figure(<span class="number">1</span>, figsize = (<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">    ax1 = fig.add_axes((<span class="number">0</span>,<span class="number">0</span>,<span class="number">.8</span>,<span class="number">.8</span>))</span><br><span class="line">    ax1.set_title(title)</span><br><span class="line">    images = X_test</span><br><span class="line">    plt.imshow(images[index].reshape(<span class="number">28</span>, <span class="number">28</span>), cmap = <span class="string">'Greys'</span>, interpolation = <span class="string">'nearest'</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_0b.png" style="width: 50%
    ; height: 300px;">
</div>


<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_1b.png" style="width: 50%
    ; height: 300px;">
</div>


<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_2b.png" style="width: 50%
    ; height: 300px;">
</div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 10. í•™ìŠµ ì‹œê°í™”í•˜ê¸°</span></span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">'accuracy'</span>])</span><br><span class="line">plt.plot(history.history[<span class="string">'val_accuracy'</span>])</span><br><span class="line">plt.title(<span class="string">'Accuracy'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'epoch'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'accuracy'</span>)</span><br><span class="line">plt.legend([<span class="string">'train'</span>, <span class="string">'test'</span>], loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">'loss'</span>])</span><br><span class="line">plt.plot(history.history[<span class="string">'val_loss'</span>])</span><br><span class="line">plt.title(<span class="string">'Loss'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'epoch'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'loss'</span>)</span><br><span class="line">plt.legend([<span class="string">'train'</span>, <span class="string">'test'</span>], loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_12_0b.png" style="width: 50%
    ; height: 300px;">
</div>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_12_1b.png" style="width: 50%
    ; height: 300px;">
</div>


<h2 id="ì‹¤ìŠµ5"><a href="#ì‹¤ìŠµ5" class="headerlink" title="ì‹¤ìŠµ5"></a>ì‹¤ìŠµ5</h2><p>ë§ˆì§€ë§‰ìœ¼ë¡œ cifar10 ë°ì´í„°ì…‹ì— ëŒ€í•œ ì´ë¯¸ì§€ ë¶„ë¥˜(Image Classification)ë¥¼ ìˆ˜í–‰í•˜ëŠ” Convolutional Neural Networks(CNNs)ì„ ë§Œë“œëŠ” ì˜ˆì œë¥¼ ìˆ˜í–‰í•˜ì˜€ë‹¤..</p>
<p>CIFAR-10ì€ ì´ë¯¸ì§€ ì¸ì‹ ë¶„ì•¼ì—ì„œ ë„ë¦¬ ì“°ì´ëŠ” ë²¤ì¹˜ë§ˆí¬ ë°ì´í„°ì…‹ ì¤‘ í•˜ë‚˜ì´ë‹¤. CIFAR-10 ë°ì´í„°ì…‹ì€ ì•„ë˜ì™€ ê°™ì´ ì´ 10ê°œì˜ ë ˆì´ë¸”ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.</p>
<p>airplane, automobile, bird, cat, deer, dog, frog, horse, ship, and truck.</p>
<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/cifar.png" style="width: 50%
    ; height: 300px;">
</div>


<p>ê°ê°ì˜ ë ˆì´ë¸”ë§ˆë‹¤ 32Ã—32 í¬ê¸° ì´ë¯¸ì§€ì¸ 50,000ê°œì˜ training ë°ì´í„°ì…‹, 10,000ê°œì˜ test ë°ì´í„°ì…‹ì´ ì¡´ì¬í•˜ê³ , ê²°ê³¼ì ìœ¼ë¡œ ì´ 60,000ê°œì˜ 32Ã—32 í¬ê¸°ì˜ ì´ë¯¸ì§€ë¡œ ë°ì´í„°ì…‹ì´ êµ¬ì„±ë˜ì–´ ìˆë‹¤.</p>
<h4 id="2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-4"><a href="#2019-11-24-ë”¥-ëŸ¬ë‹-ê³¼ì •-CNN-4" class="headerlink" title="2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN"></a>2019.11.24. ë”¥-ëŸ¬ë‹ ê³¼ì • CNN</h4><h3 id="ë„¤ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-cifar10-CNN"><a href="#ë„¤ë²ˆì§¸-ì‹¤ìŠµ-Keras-ëª¨ë¸-ìƒì„±-í•™ìŠµ-cifar10-CNN" class="headerlink" title="ë„¤ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - cifar10 : CNN"></a>ë„¤ë²ˆì§¸ ì‹¤ìŠµ. Keras ëª¨ë¸ ìƒì„±/í•™ìŠµ - cifar10 : CNN</h3><p><a href="https://keras.io/ko/datasets/#-cifar10" target="_blank" rel="external nofollow noopener noreferrer">Keras Dataset</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</span></span><br><span class="line"><span class="keyword">from</span> keras.datasets <span class="keyword">import</span> cifar10</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">(X_train, y_train), (X_test, y_test) = cifar10.load_data()</span><br><span class="line"></span><br><span class="line">X_train, X_val, y_train, y_val = train_test_split(X_train, y_train,</span><br><span class="line">                                                 test_size=<span class="number">0.2</span>,</span><br><span class="line">                                                 random_state=<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">print(X_train.shape)</span><br><span class="line">print(y_train.shape)</span><br><span class="line">print(X_val.shape)</span><br><span class="line">print(y_val.shape)</span><br><span class="line">print(X_test.shape)</span><br><span class="line">print(y_test.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(40000, 32, 32, 3)
(40000, 1)
(10000, 32, 32, 3)
(10000, 1)
(10000, 32, 32, 3)
(10000, 1)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. ì´ë¯¸ì§€ ë°ì´í„° í™•ì¸í•˜ê¸° ğŸ–¼</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">image = X_train[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">plt.imshow(image)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;matplotlib.image.AxesImage at 0x2a31e4ed948&gt;</code></pre><div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_3_1c.png" style="width: 50%
    ; height: 300px;">
</div>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3. ì´ë¯¸ì§€ ë°ì´í„° ì „ì²˜ë¦¬</span></span><br><span class="line">X_train = X_train / <span class="number">255.0</span></span><br><span class="line">X_val = X_val / <span class="number">255.0</span></span><br><span class="line">X_test = X_test / <span class="number">255.0</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. Label categorical (one-hot encoding)</span></span><br><span class="line"><span class="comment"># print(y_train[:10])</span></span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> to_categorical</span><br><span class="line"></span><br><span class="line">y_train = to_categorical(y_train)</span><br><span class="line">y_val = to_categorical(y_val)</span><br><span class="line">y_test = to_categorical(y_test)</span><br><span class="line"></span><br><span class="line">print(y_train[:<span class="number">10</span>])</span><br></pre></td></tr></table></figure>

<pre><code>[[0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5. ëª¨ë¸ ìƒì„± : CNN</span></span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dropout, Dense, Conv2D, MaxPooling2D, Flatten</span><br><span class="line"></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(Conv2D(filters=<span class="number">32</span>,</span><br><span class="line">                kernel_size=(<span class="number">3</span>,<span class="number">3</span>),</span><br><span class="line">                padding=<span class="string">'same'</span>,</span><br><span class="line">                activation=<span class="string">'relu'</span>,</span><br><span class="line">                input_shape=(<span class="number">32</span>, <span class="number">32</span>, <span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line">model.add(Conv2D(<span class="number">64</span>, (<span class="number">3</span>,<span class="number">3</span>), padding=<span class="string">'same'</span>, activation=<span class="string">'relu'</span>))</span><br><span class="line">model.add(MaxPooling2D(pool_size=(<span class="number">2</span>,<span class="number">2</span>)))</span><br><span class="line">model.add(Flatten())</span><br><span class="line"></span><br><span class="line">model.add(Dense(<span class="number">128</span>, activation=<span class="string">'relu'</span>))</span><br><span class="line">model.add(Dropout(<span class="number">0.3</span>))</span><br><span class="line">model.add(Dense(<span class="number">64</span>, activation=<span class="string">'relu'</span>))</span><br><span class="line">model.add(Dropout(<span class="number">0.2</span>))</span><br><span class="line">model.add(Dense(<span class="number">10</span>, activation=<span class="string">'softmax'</span>))</span><br><span class="line"></span><br><span class="line">print(model.summary())</span><br></pre></td></tr></table></figure>

<pre><code>Model: &quot;sequential_7&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_10 (Conv2D)           (None, 32, 32, 32)        896       
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 32, 32, 64)        18496     
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 16, 16, 64)        0         
_________________________________________________________________
flatten_7 (Flatten)          (None, 16384)             0         
_________________________________________________________________
dense_16 (Dense)             (None, 128)               2097280   
_________________________________________________________________
dropout_11 (Dropout)         (None, 128)               0         
_________________________________________________________________
dense_17 (Dense)             (None, 64)                8256      
_________________________________________________________________
dropout_12 (Dropout)         (None, 64)                0         
_________________________________________________________________
dense_18 (Dense)             (None, 10)                650       
=================================================================
Total params: 2,125,578
Trainable params: 2,125,578
Non-trainable params: 0
_________________________________________________________________
None</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6. Compile - Optimizer, Loss function ì„¤ì •</span></span><br><span class="line">model.compile(loss=<span class="string">'categorical_crossentropy'</span>,</span><br><span class="line">             optimizer=<span class="string">'adam'</span>,</span><br><span class="line">             metrics=[<span class="string">'accuracy'</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 7. ëª¨ë¸ í•™ìŠµì‹œí‚¤ê¸°</span></span><br><span class="line">batch_size = <span class="number">128</span></span><br><span class="line">epochs = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">history = model.fit(X_train, y_train,</span><br><span class="line">                    epochs=epochs,</span><br><span class="line">                    batch_size=batch_size,</span><br><span class="line">                    validation_data=(X_val, y_val), <span class="comment"># validation_set ì ìš© (ê¼­ ê°™ì´ í•´ì£¼ëŠ”ê²Œ ì¢‹ìŒ)</span></span><br><span class="line">                    verbose=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<pre><code>Train on 40000 samples, validate on 10000 samples
Epoch 1/10
40000/40000 [==============================] - 67s 2ms/step - loss: 1.7432 - accuracy: 0.3568 - val_loss: 1.3433 - val_accuracy: 0.5201
Epoch 2/10
40000/40000 [==============================] - 72s 2ms/step - loss: 1.3271 - accuracy: 0.5257 - val_loss: 1.1500 - val_accuracy: 0.5906
Epoch 3/10
40000/40000 [==============================] - 77s 2ms/step - loss: 1.1586 - accuracy: 0.5886 - val_loss: 1.0559 - val_accuracy: 0.6271
Epoch 4/10
40000/40000 [==============================] - 79s 2ms/step - loss: 1.0281 - accuracy: 0.6375 - val_loss: 0.9819 - val_accuracy: 0.6544
Epoch 5/10
40000/40000 [==============================] - 77s 2ms/step - loss: 0.9405 - accuracy: 0.6692 - val_loss: 0.9503 - val_accuracy: 0.6616
Epoch 6/10
40000/40000 [==============================] - 74s 2ms/step - loss: 0.8635 - accuracy: 0.6951 - val_loss: 0.9583 - val_accuracy: 0.6658
Epoch 7/10
40000/40000 [==============================] - 80s 2ms/step - loss: 0.7953 - accuracy: 0.7214 - val_loss: 0.9359 - val_accuracy: 0.6790
Epoch 8/10
40000/40000 [==============================] - 74s 2ms/step - loss: 0.7194 - accuracy: 0.7470 - val_loss: 0.9354 - val_accuracy: 0.6783
Epoch 9/10
40000/40000 [==============================] - 79s 2ms/step - loss: 0.6575 - accuracy: 0.7661 - val_loss: 0.9470 - val_accuracy: 0.6804
Epoch 10/10
40000/40000 [==============================] - 76s 2ms/step - loss: 0.6005 - accuracy: 0.7867 - val_loss: 1.0215 - val_accuracy: 0.6707</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 8. ëª¨ë¸ í‰ê°€í•˜ê¸°</span></span><br><span class="line">test_loss, test_acc = model.evaluate(X_test, y_test)</span><br></pre></td></tr></table></figure>

<pre><code>10000/10000 [==============================] - 5s 517us/step</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 9. ì´ë¯¸ì§€ë¥¼ ëœë¤ìœ¼ë¡œ ì„ íƒí•´ í›ˆë ¨ëœ ëª¨ë¸ë¡œ ì˜ˆì¸¡ ğŸ–¼</span></span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> numpy.random.choice(len(y_test), <span class="number">3</span>, replace = <span class="literal">False</span>):</span><br><span class="line">    predicted = model.predict(X_test[index:index + <span class="number">1</span>])[<span class="number">0</span>]</span><br><span class="line">    label = y_test[index]</span><br><span class="line">    result_label = numpy.where(label == numpy.amax(label))</span><br><span class="line">    result_predicted = numpy.where(predicted == numpy.amax(predicted))</span><br><span class="line">    title = <span class="string">"Label value = %s  Predicted value = %s "</span> % (result_label[<span class="number">0</span>], result_predicted[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    fig = plt.figure(<span class="number">1</span>, figsize = (<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">    ax1 = fig.add_axes((<span class="number">0</span>,<span class="number">0</span>,<span class="number">.8</span>,<span class="number">.8</span>))</span><br><span class="line">    ax1.set_title(title)</span><br><span class="line">    images = X_test</span><br><span class="line">    plt.imshow(images[index], interpolation = <span class="string">'nearest'</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_10_0c.png" style="width: 50%
    ; height: 300px;">
</div>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_10_1c.png" style="width: 50%
    ; height: 300px;">
</div>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_10_2c.png" style="width: 50%
    ; height: 300px;">
</div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 10. í•™ìŠµ ì‹œê°í™”í•˜ê¸°</span></span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">'accuracy'</span>])</span><br><span class="line">plt.plot(history.history[<span class="string">'val_accuracy'</span>])</span><br><span class="line">plt.title(<span class="string">'Accuracy'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'epoch'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'accuracy'</span>)</span><br><span class="line">plt.legend([<span class="string">'train'</span>, <span class="string">'test'</span>], loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">'loss'</span>])</span><br><span class="line">plt.plot(history.history[<span class="string">'val_loss'</span>])</span><br><span class="line">plt.title(<span class="string">'Loss'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'epoch'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'loss'</span>)</span><br><span class="line">plt.legend([<span class="string">'train'</span>, <span class="string">'test'</span>], loc=<span class="string">'upper left'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_0c.png" style="width: 50%
    ; height: 300px;">
</div>


<div style="width: 100%; height: 300px;">
    <img src="https://kyu9341.github.io/img/output_11_1c.png" style="width: 50%
    ; height: 300px;">
</div>



<p>ì°¸ì¡°<br><a href="https://umbum.tistory.com/223" target="_blank" rel="external nofollow noopener noreferrer">https://umbum.tistory.com/223</a><br><a href="https://untitledtblog.tistory.com/150" target="_blank" rel="external nofollow noopener noreferrer">https://untitledtblog.tistory.com/150</a><br><a href="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/" target="_blank" rel="external nofollow noopener noreferrer">https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/</a><br><a href="http://solarisailab.com/archives/1700" target="_blank" rel="external nofollow noopener noreferrer">http://solarisailab.com/archives/1700</a></p>


                <hr>

                

                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/ì˜ìƒì²˜ë¦¬/2019/11/29/ImageProcessing4/" data-toggle="tooltip" data-placement="top" title="ë””ì§€í„¸ ì˜ìƒì²˜ë¦¬ - Bit Plane">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/MachineLearning/2019/11/23/marchinelearning3/" data-toggle="tooltip" data-placement="top" title="ICTë©˜í† ë§ ë”¥ëŸ¬ë‹ êµìœ¡ 1ì¼ì°¨">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                

                
                <!-- disqus è¯„è®ºæ¡† start -->
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                <!-- disqus è¯„è®ºæ¡† end -->
                

            </div>
    <!-- Side Catalog Container -->
        

    <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="http://blog.kaijun.rocks" target="_blank" rel="external nofollow noopener noreferrer">Kaijun&#39;s Blog</a></li>
                    
                        <li><a href="http://huangxuan.me" target="_blank" rel="external nofollow noopener noreferrer">Hux Blog</a></li>
                    
                        <li><a href="#" target="_blank">Foo</a></li>
                    
                        <li><a href="#" target="_blank">Bar</a></li>
                    
                        <li><a href="#" target="_blank">Example Friends</a></li>
                    
                        <li><a href="#" target="_blank">It helps SEO</a></li>
                    
                </ul>
                
            </div>

        </div>
    </div>
</article>




<!-- disqus å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "kyu9341-github-io";
    var disqus_identifier = "https://kyu9341.github.io/MachineLearning/2019/11/24/marchinelearning4/";
    var disqus_url = "https://kyu9341.github.io/MachineLearning/2019/11/24/marchinelearning4/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus å…¬å…±JSä»£ç  end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                    <li>
                        <a target="_blank" href="https://twitter.com/Demonbane_x" rel="external nofollow noopener noreferrer">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/Demonbane" rel="external nofollow noopener noreferrer">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">çŸ¥</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/Demonbane" rel="external nofollow noopener noreferrer">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://www.facebook.com/demonbane.cn" rel="external nofollow noopener noreferrer">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://github.com/kyu9341" rel="external nofollow noopener noreferrer">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/kaijun-chen-42089354" rel="external nofollow noopener noreferrer">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; kwon&#39;s Blog 2019 
                    <br>
                    Theme by <a href="http://huangxuan.me" target="_blank" rel="external nofollow noopener noreferrer">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    Ported by <a href="http://blog.kaijun.rocks" target="_blank" rel="external nofollow noopener noreferrer">Kaijun</a> | 
                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=kaijun&repo=hexo-theme-huxblog&type=star&count=true">
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://kyu9341.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-146069634-1';
    var _gaDomain = 'kyu9341.github.io';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = '4cc1f2d8f3067386cc5cdb626a202900';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>


<!-- Side Catalog -->





<!-- Image to hack wechat -->
<img src="https://kyu9341.github.io/img/icon_wechat.png" width="0" height="0">
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
